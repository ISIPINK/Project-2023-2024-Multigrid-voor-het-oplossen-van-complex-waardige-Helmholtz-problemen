
\documentclass[a4paper,12pt]{article}

\setlength{\textwidth}{15.0cm}
\setlength{\textheight}{24.0cm}
\setlength{\topmargin}{0cm}
\setlength{\headsep}{0cm}
\setlength{\headheight}{0cm}
\pagestyle{plain}

\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=blue,
    citecolor=blue,
    linktoc=page
}
\usepackage[dvips]{epsfig}
\usepackage{tikz}
\usepackage[english]{babel}
\usepackage{caption}
\captionsetup{font=it}
\usepackage[autostyle, english=american]{csquotes}

\usepackage[
backend=biber,
style=alphabetic,
]{biblatex}

\renewcommand{\bibfont}{\footnotesize}

\usepackage{amsmath,amssymb,amsthm}

\usepackage{comment}
\usepackage{listings}

% \addbibresource{bibliography2.bib} 
\setlength{\parindent}{0pt}

\selectlanguage{english}
\begin{document}

\title{Multigrid for solving complex-valued Helmholtz problems}
\author{Isidoor Pinillo Esquivel}
\date{\today}
\maketitle

\section{Failure of the Multigrid method for Helmholtz problems: analysis}

\subsection{Discretization}
(a)
\begin{align*}
    10                    & \leq \lambda \text{ \#gridpoints} \Leftrightarrow                \\
    10                    & \leq \frac{2\pi}{\sqrt{|\sigma|}} \frac{1}{h^{d}}\Leftrightarrow \\
    \sqrt{|\sigma|} h^{d} & \leq \frac{2 \pi}{10} \approx 0.625.
\end{align*}

(b)
\[
    \text{\# roosterpunten} = \frac{10 \sqrt{600}}{2 \pi}
    .\]

\subsection{1D model problem}
(a) \\
To proof : $H^{2 h} \neq I_h^{2 h} H^h I_{2 h}^h$.
\begin{align*}
    H^{2h} & = H_n = A_n +\sigma {id}_n          \\
    H^{h}  & = H_{2n} = A_{2n} +\sigma {id}_{2n}
\end{align*}
Assume that $A_n =I_h^{2 h} A_{2n} I_{2 h}^h= R_{2n} A_{2n} I_n$. By linearity it is  sufficient
to proof:
\begin{align*}
    \sigma {id}_n  & \neq \sigma R_{2n} {id}_{2n} I_{n} \Leftrightarrow \\
    {id}_n         & \neq R_{2n} I_{n} \Leftarrow                       \\
    (id_n)_{00} =1 & \neq \frac{3}{4} = (R_{2n} I_{n})_{00}
\end{align*}

First equivalence follows from $\sigma \neq 0$. The assumption and the last inequality depends on the definition of
restriction and interpolation. \\
(b) \\
See code/main.ipynb for code and plots. We implemented $f(t) = \delta(t-0.5)$ by concentrating all the mass into the
middle element of $f_n$.\\
(c) \\
There exists a closed formula for eigenvalues and eigenvectors of tridiagonal toeplitz matrix. It is just tedious to
use. Alternatively the eigenvalues and eigenvectors can be derived from the Poisson problem ($\sigma=0$) because
\begin{align*}
    Av             & = \lambda v \Rightarrow \\
    (A+\sigma id)v & = Av + \sigma v         \\
                   & = (\lambda+\sigma)v
\end{align*}
i.e. eigenvectors stay the same and eigenvalues get shifted by $\sigma$. \\

(d) \\
See code/main.ipynb for the plot. $\sigma = 0$ is the boundary where $H$ goes from indefinite to definite.

\subsection{LFA analysis of the $\omega$-Jacobi smoother}
(a) \\
For grid points without a neighboring boundary point there
$H$ acts like following stencil:
\[
    H_n = n^{2} [ -1 \quad 2+ \frac{\sigma}{n^{2}}  \quad -1]
    .\]

So $R_{\omega}$ works element wise the following way on the error:
\begin{equation}
    e_{j}^{m+1} = (1-\omega) e_{j} ^{m} + \frac{\omega n^{2}}{2 n^{2} + \sigma} (e_{j-1} ^{m} + e_{j+1}^{m})
    .
\end{equation}
Very similar to the analysis for the Poisson equation. Note that we haven't used that $\sigma$ is real.
Doing the LFA subsitution $e_j^{(m)}=\mathcal{A}(m) e^{i j \theta}$:

\begin{align*}
    A(m+1) & = A(m) \left( 1-\omega + \frac{\omega n^{2}}{2 n^{2} + \sigma} (e^{-i\theta} + e^{i\theta}) \right) \\
           & = A(m) \left( 1-\omega + 2 \cos(\theta) \frac{\omega n^{2}}{2 n^{2} + \sigma}   \right)
\end{align*}
The factor in behind of $A(m)$ is the amplification factor $G(\theta)$.

(b) \\
$\sigma = 0$ reduces back to the LFA we did for the Poisson equation.
$\theta \approx 0 \Rightarrow \cos(\theta)
    \approx 1 + O \left(\frac{1}{n^{2}}\right) \Rightarrow G(\theta) \approx 1 - O \left(\frac{1}{n^{2}}\right)$
so smooth modes are preserved for big $n$.
(c) \\
See code/main.ipynb for the plot. \\

(d)\\
Maximum of $G(\theta)$ is achieved at $\theta =0$ because $G(\theta)$ is just
an increasing function of $\cos(\theta)$. This means that
$\rho = 1-\omega + 2 \frac{\omega n^{2}}{2 n^{2} + \sigma}  \approx 1.05 $
which suggests that weighted jacobi wouldn't converge.


\subsection{Spectral analysis of the two-grid correction scheme}
(a) \\
It is easily seen that
\begin{equation}
    R_{2n} =  c S_{2n} (3id -A_{2n}).
\end{equation}
with $c \in \mathbb{R}_{0}$, $S_{2n}: \mathbb{R}^{2n-1} \rightarrow \mathbb{R}^{n-1}: (v_{j})_{j \leq 2n-2}
    \rightarrow (v_{2j+1})_{j \leq n-2}$  subsampling uneven components.
Using that $S_{2n}w_{k}^{2n} = w_{k}^{n}$ if $k<n$ it is easily seen that:
\begin{align*}
    R_{2n} w_{k}^{2n} & = cS_{2n}(3id- A_{2n}) w_{k}^{2n}             \\
                      & = c(3- \lambda_{k}(A_{2n})) S_{2n} w_{k}^{2n} \\
                      & = a(n,k) w_{k}^{n} .
\end{align*}
In our case $I_{n}$ is linear interpolation, reconstuction error for lagrange interpolation can be bounded
using Taylors theorem.
\begin{equation}
    I_{n} S_{2n} v_{2n}  \approx c v_{2n}.
    .
\end{equation}
For $w_{k}^{2n}$ smooth and combining with previous argument we have:
\begin{equation}
    I_{n} R_{2n} w_{2n}  \approx c_{1} w_{2n}.
\end{equation}
To check the normalizing constant try $v_{2n} = 1 \Rightarrow c_{1} =1$. \\
We also checked these facts numerically by plotting see code. Now doing spectral analysis of TG is
straight forward:
\begin{align*}
    TG w_{k}^{2n} & = (id - I_{n} H_{n}^{-1} R_{2n} H_{2n}) w_{k}^{2n}                                    \\
                  & =  w_{k}^{2n} - I_{n} H_{n}^{-1} R_{2n} \lambda_{k}(H_{2n}) w_{k}^{2n}                \\
                  & =  w_{k}^{2n} - I_{n} H_{n}^{-1}  a(n,k) w_{k}^{n} \lambda_{k}(H_{2n})                \\
                  & =  w_{k}^{2n} - I_{n}  a(n,k) w_{k}^{n} \lambda_{k}(H_{n}^{-1})  \lambda_{k}(H_{2n})  \\
                  & =  w_{k}^{2n} - I_{n}  R_{2n} w_{k}^{2n} \lambda_{k}(H_{n}^{-1})  \lambda_{k}(H_{2n}) \\
                  & \approx  w_{k}^{2n} -  w_{k}^{2n} \lambda_{k}(H_{n}^{-1})  \lambda_{k}(H_{2n})        \\
                  & \approx  w_{k}^{2n} (1-   \lambda_{k}(H_{n}^{-1})  \lambda_{k}(H_{2n}))
\end{align*}

(b) \\
We already analytically derived the eigenvalues for $H_{n}$. For the plot see code.\\
TG iterations may amplify smooth modes when $\rho_{k} >1$. \\
(c)\\
See code for the plots. $\rho_{k} >1$ when the sign changes. In the previous case the
index closest to the sign change is $k = 6$. No, the smoother leaves smooth modes almost unchanged.



\section{Solving the complex-valued Helmholtz problem using Multigrid}


\subsection{1D model problem}
(a) \\
see code

(b)\\
For a point source it may not be obvious but the solutions
for complex shifted problem is very similar.

(c) \\
see code

\subsection{LFA analysis of the $\omega$-Jacobi smoother}
(a) \\
Already answered in previous question. $\rho$ is still $|G(\theta)|$ almost the same reasoning.
\begin{equation}
    |G(\theta)| = |a + b \cos(\theta) + c \cos(\theta)i|
\end{equation}
with $a,b \in \mathbb{R}^{+}$ and $c \in  \mathbb{R}$ still gets optimized when $\cos\left(\theta\right)$
gets optimized. Using that argument requires that $2n^{2}+R(\sigma)\geq 0$ which follows from the criterium on
$n$ we placed at the start.

(b) \\
Depending on $\beta$ the smoother may be stable. \\
(c) \\
We think $|G(\pi)|$ or $|G(\frac{\pi}{2})|$. We have numerical evidence not a proof yet.
(d) \\
Eyeballing the plot we made $\omega \approx 0.65$ is good.

\subsection{Spectral analysis of the two-grid correction scheme}
(a) \\
Already did that. See code. Well with the formula not numerical eigenvalues ... \\
(b) \\
The instability in $\rho_{k}$ dampens.


\subsection{2D model problem}
(a) \\
Solve happens in the code.
(b) \\
Less iterations are needed for the same amount of error. This is because
$\sigma$ the source of the problem get relatively smaller to $n^{2}$ in
our convergence factors, asymptotically behavior should go back the
Laplace problem.

\subsection{Aggressive coarsening}

\section{Multigrid as a preconditioner for Krylov subspace methods}

\subsection{MG-GMRES for the indefinite Helmholtz problem}

\end{document}

% Base your answers on the thesis.  
% You are expert in giving and revising homework.
%
% Answer as a markdown file.
% Use subnumerings in mark down form in numbering the question 
% that works in a markdown file and use different headers. Like this: 
%
% #  1. Question?
% answer
%
% Here are the questions : 
% 1. Are all requirements of the project met?
% 2. Are there any writing errors?
% 3. What are the most unclear parts in the report?
% 4. Suggest improvements. 